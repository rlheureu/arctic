{% extends "base.html" %}
{% block styling %}
  {{ super() }}
  <style type="text/css">
    .section1{
      width:100%;
      background-image: url("//d2h81apir9utb4.cloudfront.net/images/section1-bg.jpg");
      background-repeat:no-repeat;
      background-position: center top;
      position:relative;
      width: 100%;
      margin-left: 0;
      margin-right: 0;
      border-bottom: solid 12px #394a65;
    
    }
    .ppsection{
      width:100%;
      background-image: url("//d2h81apir9utb4.cloudfront.net/images/section3bg-image.jpg");
      background-position: center top;
      background-repeat:no-repeat;
      border-bottom: solid 12px #394a65;
      display: none; 
    }
    .section3{
      width:100%;
      background-image: url("//d2h81apir9utb4.cloudfront.net/images/section3bg-image.jpg");
      background-position: center top;
      background-repeat:no-repeat; 
    }
    .section4{
      width:100%;
      background-image: url("/static/images/bg-social.png");
      background-position: center top;
      background-size: cover;
      width: 100%;
      margin-left: 0;
      margin-right: 0;
    }
    .section5{
      width:100%;
      background-image: url("//d2h81apir9utb4.cloudfront.net/images/section3bg-image.jpg");
      background-position: center top;
      background-repeat:no-repeat; 
    }
    .landing-header{
      width: 100%;
      border-left: solid 3px #aaa;
      border-right: solid 3px #aaa;
      text-align: center;
    }
    .anchor{
      display: block;
      position: relative;
      top: 191px;
    }
    
    .lp-cube-image{
      width: 60px;
      padding-left: -10px;
      padding-right: 15px;
    }
    
    .tt-query {
      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
      -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
    }
    .tt-hint {
      color: #ccc;
    }
    .tt-menu {    /* used to be tt-dropdown-menu in older versions */
      width: 422px;
      margin-top: 4px;
      padding: 4px 0;
      background-color: #091933;
      border: 1px solid #ccc;
      border: 1px solid rgba(0, 0, 0, 0.2);
      font-size: 15px;
      text-align: left;
      -webkit-box-shadow: 0 5px 10px rgba(0,0,0,.2);
         -moz-box-shadow: 0 5px 10px rgba(0,0,0,.2);
              box-shadow: 0 5px 10px rgba(0,0,0,.2);
    }
    .tt-suggestion {
      padding: 3px 20px;
      line-height: 24px;
      cursor: pointer;
    }
    .tt-suggestion.tt-cursor,.tt-suggestion:hover {
      color: #ffffff;
      background-color:#000000;
    }
    .tt-suggestion p {
      margin: 0;
    }
    .scrollable-dropdown-menu .tt-menu {
      max-height: 200px;
      overflow-y: auto;
    }
    .tt-item-right {
      display: inline-block;
    }
    .tt-item-left {
      display: inline-block;
      vertical-align: top;
    }
    .tt-item-price{
      font-size: 13px;
      color: #00bf00;
    }
    .twitter-typeahead{
     width: 97%;
    }
    .tt-dropdown-menu{
        width: 102%;
    }
    
    ::-webkit-input-placeholder { /* WebKit, Blink, Edge */
    color:    #00dcff;
    }
    :-moz-placeholder { /* Mozilla Firefox 4 to 18 */
       color:    #00dcff;
       opacity:  1;
    }
    ::-moz-placeholder { /* Mozilla Firefox 19+ */
       color:    #00dcff;
       opacity:  1;
    }
    :-ms-input-placeholder { /* Internet Explorer 10-11 */
       color:    #00dcff;
    }
    ::-ms-input-placeholder { /* Microsoft Edge */
       color:    #00dcff;
    }
    
    input[type="text"].lpp-input {
      outline: none;
      border:none;
      border-bottom: solid 3px #00dcff;
      background: transparent;
      font-weight: 700;
      min-width: 100%;
      font-size: 16px;
      color: #eeeeee;
       cursor: pointer;
    }
    input[type="text"].lpp-input:focus {
      border-bottom: solid 5px #00dcff;
    }
    input[type="email"].subscribe-input {
      outline: none;
      border:none;
      border-bottom: solid 3px #00dcff;
      background: transparent;
      font-weight: 700;
      width:100%;
      font-size: 16px;
      color: #eeeeee;
    }
    
  </style>
{% endblock %}


{% block content %}
  <div class="section1" id="top">
  
    <div class="container">
      <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8" style="text-align: center;">
          <div class="hidden-xs hidden-sm"><br></div>
          <br><br>
        </div>
        <div class="col-md-2"></div>
      </div>
      <div class="row">
        <div class="col-md-12 landing-header"><h1 style="padding:0px;margin:0px;">HOW WILL IT PERFORM?</h1></div>
      </div>
      <div class="row">
        <div class="col-md-8 col-md-offset-2" style="text-align: center;">
          <br>
          <p style="color:#eee; font-size:17px;">
            Considering new parts? Know performance data before you buy.<br>Drop the parts in below to see how they'll perform before you buy!<br>
          </p>
          <br><br>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4 col-md-offset-2">
          <br>
          <p style="color:#eee; font-size:20px; font-weight: bold;">Select your parts here</p>
          <br>
          <div class="scrollable-dropdown-menu">
            <input type="text" class="typeahead lpp-input" id="cpu-ta-input" placeholder="Select Processor"/>
          </div>
          <br><br>
          <div class="scrollable-dropdown-menu">
            <input type="text" class="typeahead lpp-input" id="gpu-ta-input" placeholder="Select Graphics Card"/>
          </div>
          <br><br>
          <br><br>
        </div>
        <div class="col-md-3 col-md-offset-1">
          <br>
          <p style="color:#eee; font-size:20px; font-weight: bold;">Don't see what you're looking for?</p>
          <p style="color:#eee;">If you'd like to us to notify you when new performance data is available subscribe to our mailing list below.</p>
          <div class="text-center">
            <br>
            <a href="/subscribe" class="ac-btn">Subscribe to be notified</a>
            <br><br>
          </div>
        </div>
      </div>
    </div>
  
  </div>
  <div class="ppsection">
    <div class="container">
      <div class="row">
        <div class="col-md-10 col-md-offset-1 text-center" id="the-cube-js-div" style="padding-top:25px;">
          
        </div>
      </div>
    </div>
  </div>
  <div class="section3">
    <div class="container">
      <div class="row">
        <br><br><br>
        <div id="how-it-works"></div>
        <br><br><br><br>
        <div class="col-md-12 landing-header"><h1 style="padding:0px;margin:0px;color:#eeeeee;">DESIGN YOUR RIG</h1></div>
        <br><br><div class="hidden-xs hidden-sm"><br><br></div>
      </div>
      <div class="row">
        <div class="col-md-8 col-md-offset-2" style="text-align: center;">
          <p style="font-size: 30px; color: #eeeeee;">Building for performance simplified</p>
          <hr style="border: 0; border-top: 4px solid #998; width: 300px;">
          <p style="color: #eeeeee; font-size: 15px;">Amdahl Cube makes it easy to build a PC and understand the performance you can expect as you go.</p>
          <br>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-3" style="text-align: center;">
          <div class="hidden-xs hidden-sm">
            <img src="//d2h81apir9utb4.cloudfront.net/images/icon_section3_1.png" style="width:80%;"> <!-- DESKTOP -->
            <p style="color:#eeeeee;; font-size: 15px;">Designing a PC is as easy as equipping an item.</p>
          </div>
          <div class="hidden-md hidden-lg">
            <img src="//d2h81apir9utb4.cloudfront.net/images/icon_section3_1.png" style="width:175px;"> <!-- MOBILE -->
            <p style="color:#eeeeee;; font-size: 15px;">Designing a PC is as easy as equipping an item.</p>
          </div>
        </div>
        <div class="col-sm-3" style="text-align: center;">
          <div class="hidden-xs hidden-sm">
            <img src="//d2h81apir9utb4.cloudfront.net/images/icon_section3_2.png" style="width:80%;"> <!-- DESKTOP -->
            <p style="color:#eeeeee;; font-size: 15px;">Components that directly influence performance have been ranked and color coded.</p>
          </div>
          <div class="hidden-md hidden-lg">
            <img src="//d2h81apir9utb4.cloudfront.net/images/icon_section3_2.png" style="width:175px;"> <!-- MOBILE -->
            <p style="color:#eeeeee;; font-size: 15px;">Components that directly influence performance have been ranked and color coded.</p>
          </div>
        </div>
        <div class="col-sm-3" style="text-align: center;">
          <div class="hidden-xs hidden-sm">
            <img src="//d2h81apir9utb4.cloudfront.net/images/icon_section3_3.png" style="width:80%;"> <!-- DESKTOP -->
            <p style="color:#eeeeee;; font-size: 15px;">Match components of the same color to get a system at that performance tier.</p>
          </div>
          <div class="hidden-md hidden-lg">
            <img src="//d2h81apir9utb4.cloudfront.net/images/icon_section3_3.png" style="width:175px;"> <!-- MOBILE -->
            <p style="color:#eeeeee;; font-size: 15px;">Match components of the same color to get a system at that performance tier.</p>
          </div>
        </div>
        <div class="col-sm-3" style="text-align: center;">
          <div class="hidden-xs hidden-sm">
            <img src="//d2h81apir9utb4.cloudfront.net/images/icon_section4_1.png" style="width:80%;"> <!-- DESKTOP -->
            <p style="color:#eeeeee;; font-size: 15px;">Easily identify bottlenecks in your system and know which part to upgrade next.</p>
          </div>
          <div class="hidden-md hidden-lg">
            <img src="//d2h81apir9utb4.cloudfront.net/images/icon_section4_1.png" style="width:175px;"> <!-- MOBILE -->
            <p style="color:#eeeeee;; font-size: 15px;">Easily identify bottlenecks in your system and know which part to upgrade next.</p>
          </div>
        </div>
      </div>
      <div class="row"><div class="col-xs-12"><br><br><br><br><br><br></div></div>
    </div>
  </div>
  
  <div class="section4">
    <div class="container">
      <div class="row" style="text-align: center;">
        <br><br><br>
        <div id="showcase"></div>
        <br><br><br><br>
        <div class="col-md-12 landing-header"><h1 style="padding:0px;margin:0px;color:#eee;">TAKE IT WITH YOU</h1></div>
        <br><br><br><br><br>
        <hr style="border: 0; border-top: 4px solid #eee; width: 300px;">
        
      </div>
      <div class="row">
        <div class="col-xs-4 text-center">
          <div class="hidden-xs hidden-sm">
            <img src="/static/images/icons_section4_social_twitter.png">
          </div>
          <div class="hidden-md hidden-lg">
            <img src="/static/images/icons_section4_social_twitter.png" style="width:80px;">
          </div>
        </div>
        <div class="col-xs-4 text-center">
          <div class="hidden-xs hidden-sm">
            <img src="/static/images/icons_section4_social_facebook.png">
          </div>
          <div class="hidden-md hidden-lg">
            <img src="/static/images/icons_section4_social_facebook.png" style="width:80px;">
          </div>
        </div>
        <div class="col-xs-4 text-center">
          <div class="hidden-xs hidden-sm">
            <img src="/static/images/icons_section4_social_reddit.png">
          </div>
          <div class="hidden-md hidden-lg">
            <img src="/static/images/icons_section4_social_reddit.png" style="width:80px;">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-8 col-md-offset-2" style="text-align: center;">
          <br><br>
          <p style="font-size: 30px; color:#eee;">A PC is a box at your feet and your ticket to new worlds and communities.</p>
          <br>
          <p style="color:#eee; font-size: 15px;">Take your cube with you to your favorite places. Share it with your PCMR friends. Post it for your Twitch followers. Take pride in your cube.</p>
          <br><br><br><br><br>
        </div>
      </div>
    </div>
  </div>
  
  <div class="section5">
  
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-md-offset-2" style="text-align: center;">
          <br><br><br><br><br>
          <p style="font-size: 30px; color:#eee;">We'll Be Ready</p>
          <br>
          <hr style="border: 0; border-top: 4px solid #eee; width: 300px;">
          <br>
          <p style="color:#eee; font-size: 15px;">PC hardware is always getting better. We'll keep you updated when new parts come out. Let us help you upgrade your rig or pick out the perfect rig for the friends that have your back in the arena.</p>
          <br><br><br><br><br><br>
        </div>
      </div>
    </div>
  </div>
  
{% endblock %}

{% block javascript %}
<script type="text/javascript" src="/static/js/typeahead.bundle.min.js"></script>
<script type="text/javascript">

    $(function(){
        
        var selectedGpu = null;
        var selectedCpu = null;
        
        function refreshBars(){
            
            var params = {};
            if (selectedCpu) params['c'] = selectedCpu.id;
            if (selectedGpu) params['g'] = selectedGpu.id;
            $.getJSON('/pp', params)
            .success(function(data){
                drawBars('the-cube-js-div', data.renderbars);
            });
            
            
            var genreKeys = ['PUBG', 'FPS', 'OPEN_WORLD'];
        }
        
        function initTypeAhead(compList, elmId, suggest, cType) {
            var engine = new Bloodhound({
                local : compList,
                identify : function(obj) { return obj.id; },
                queryTokenizer : Bloodhound.tokenizers.nonword,
                datumTokenizer : Bloodhound.tokenizers.obj.nonword('display_name')
            });
            
            $('#' + elmId).typeahead({ minLength : 0, highlight : true}, {
                limit: 15,
                name : elmId + '_Dataset',
                source : function(q, sync) {
                    if (q === '') sync(engine.get(suggest));
                    else {
                        engine.search(q, sync);
                    }
                },
                display: 'display_name',
                templates: {
                    suggestion: function(obj) {
                        var suggHtml = '<div class="fg-' + obj.perf_color + '">';
                        suggHtml += '<div class="tt-item-left"><img class="lp-cube-image" src="/static/cube-images/ac-cube-small-' + obj.perf_color + '.png" /></div>';
                        suggHtml += '<div class="tt-item-right" style="display:inline-block;">' + obj.display_name;
                        suggHtml += '<br><span class="tt-item-price">' + obj.priceformatted + '</span></div></div>';
                        return suggHtml;
                    }
                }
            }).bind('typeahead:select', function(jqueryevent, obj){
                
                if (!$('.ppsection').is(":visible")) $('.ppsection').show();
                
                if (cType === 'CPU') selectedCpu = obj;
                else if (cType === 'GPU') selectedGpu = obj;
                
                $('#' + elmId).removeClass(function(idx, className){
                    var classes = className.split(' ');
                    for (var i=0;i<classes.length;i++) {
                        if (classes[i].startsWith('fg')) {
                            return classes[i];
                        }
                    }
                }).addClass('fg-' + obj.perf_color);
                
                refreshBars();
                
                // deselect input
                $('input').blur();
                
            }).bind('typeahead:active', function(){
                $('#' + elmId).typeahead('val', null);
            });
        }
        
        $.getJSON('/landingpageparts', function(jsonData){
            
            initTypeAhead(jsonData.cpus, 'cpu-ta-input', jsonData.suggest.cpu, 'CPU');
            initTypeAhead(jsonData.gpus, 'gpu-ta-input', jsonData.suggest.gpu, 'GPU');
        });

        
        //
        //
        //
        //
        //
        // RENDERING BARS
        // ////////
        var initializedCanvas = {};
        
        function initCanvasInDiv(divElmId, w, h) {
            
            var canvas = null;
            if (initializedCanvas[divElmId]) {
                canvas = initializedCanvas[divElmId];
                canvas.id = "canvas_" + divElmId;
                
            } else {
                canvas = document.createElement('canvas');
                var div = document.getElementById(divElmId);
                div.appendChild(canvas);
                initializedCanvas[divElmId] = canvas;
            }
            
            canvas.width = w * (window.devicePixelRatio || 1);
            canvas.height = h * (window.devicePixelRatio || 1);
            canvas.style.width = w + 'px';
            canvas.style.height = h + 'px';
            
            return canvas;
        }
    
        
        var renderedBarsByElm = {};
        function drawBars(elmId, bars) {
            // the list of bars passed in are to be rendered on the canvas
            // this method will call the render function the necessary
            // number of times in order to animate the changing size of the bars
            
            // there are two bars for each genre
            // they both need to be animated?
            
                    
            var renderedBars = renderedBarsByElm[elmId]; // if multiple canvases
            if (!renderedBars) {
                renderedBars = {};
                renderedBarsByElm[elmId] = renderedBars;
            }
            
            if (Object.keys(renderedBars).length === 0) {
                // first render so populate with initial bars
                for (var i=0; i<bars.length; i++) {
                    renderedBars[bars[i]['title']] = {};
                    renderedBars[bars[i]['title']].fill1080p = 0;
                    renderedBars[bars[i]['title']].fill1440p = 0;
                    renderedBars[bars[i]['title']].fill2160p = 0;
                    renderedBars[bars[i]['title']].size = 0;
                }
            }
            
            // now determine step size
            var stepCount = 30; // 60 fps and half second animation time
            var stepSizes = {};
            for (var i=0; i<bars.length; i++) {
                bars[i]['barFillStepSize1080p'] = (bars[i]['barFillFps1080p'] - renderedBars[bars[i]['title']].fill1080p) / stepCount;
                bars[i]['barFillStepSize1440p'] = (bars[i]['barFillFps1440p'] - renderedBars[bars[i]['title']].fill1440p) / stepCount;
                bars[i]['barFillStepSize2160p'] = (bars[i]['barFillFps2160p'] - renderedBars[bars[i]['title']].fill2160p) / stepCount;
                bars[i]['barFillFps1080pBefore'] = renderedBars[bars[i]['title']].fill1080p;
                bars[i]['barFillFps1440pBefore'] = renderedBars[bars[i]['title']].fill1440p;
                bars[i]['barFillFps2160pBefore'] = renderedBars[bars[i]['title']].fill2160p;
                
                bars[i]['barSizeStepSize'] = (bars[i]['barSizeFps'] - renderedBars[bars[i]['title']].size) / stepCount;
                bars[i]['barSizeFpsBefore'] = renderedBars[bars[i]['title']].size;
                
                renderedBars[bars[i]['title']].fill1080p = bars[i]['barFillFps1080p']; // update the old size
                renderedBars[bars[i]['title']].fill1440p = bars[i]['barFillFps1440p']; // update the old size
                renderedBars[bars[i]['title']].fill2160p = bars[i]['barFillFps2160p']; // update the old size
                renderedBars[bars[i]['title']].size = bars[i]['barSizeFps']; // update the old size
            }
            
            renderInsideElement(elmId, bars, 0, 30);
        }
        
        function getLines(ctx, text, maxWidth) {
            var words = text.split(" ");
            var lines = [];
            var currentLine = words[0];

            for (var i = 1; i < words.length; i++) {
                var word = words[i];
                var width = ctx.measureText(currentLine + " " + word).width;
                if (width < maxWidth) {
                    currentLine += " " + word;
                } else {
                    lines.push(currentLine);
                    currentLine = word;
                }
            }
            lines.push(currentLine);
            return lines;
        }
        
        function roundRect(ctx, x, y, width, height, radius, fill, stroke) {
            if (typeof stroke == 'undefined') {
                stroke = true;
            }
            if (typeof radius === 'undefined') {
                radius = 5;
            }
            if (typeof radius === 'number') {
                radius = {tl: radius, tr: radius, br: radius, bl: radius};
            } else {
                var defaultRadius = {tl: 0, tr: 0, br: 0, bl: 0};
                for (var side in defaultRadius) {
                    radius[side] = radius[side] || defaultRadius[side];
                    }
            }
            ctx.beginPath();
            ctx.moveTo(x + radius.tl, y);
            ctx.lineTo(x + width - radius.tr, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);
            ctx.lineTo(x + width, y + height - radius.br);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height);
            ctx.lineTo(x + radius.bl, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);
            ctx.lineTo(x, y + radius.tl);
            ctx.quadraticCurveTo(x, y, x + radius.tl, y);
            ctx.closePath();
            if (fill) {
                ctx.fill();
            }
            if (stroke) {
                ctx.stroke();
            }
        }
        
        function renderInsideElement(elmId, bars, stepCount, maxSteps) {
            
            var reportTitle = 'FPS Performance Report';
            var barMargin = 16; // bar margin (space between bars)
            var barHeight = 13; // bar height
            var legendWidth = 220;
            var legendHeight = 48;
            var legendPadding = 15;
            var sectionHeight = ((barMargin - barHeight) * 2) + barHeight *3;
            var sectionPaddingBottom = 50;
            var titleSectionHeight = 100;
            var cpuBarsColor = '#04bf1e';
            var gpuBarsColor = '#FF0000';
            var backgroundColor = '#121526';
            var backgroundBarsColor = '#000000';
            var barBorderRadius = barHeight/4;
            
            var cWidth = document.getElementById(elmId).clientWidth - 40;
            var cHeight = (bars.length * (sectionHeight + sectionPaddingBottom)) + (legendPadding * 2) + legendHeight + titleSectionHeight;
            
            var canvas = initCanvasInDiv(elmId, cWidth, cHeight);
    
            var ctx = canvas.getContext('2d');
            
            if (window.devicePixelRatio && window.devicePixelRatio > 1) {
                console.log(window.devicePixelRatio);
                ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            }
            
            ctx.clearRect(0, 0, cWidth, cHeight);
            
            //ctx.fillStyle = backgroundColor;
            //ctx.fillRect(0, 0, cWidth, cHeight);
            
            ctx.font = '22px  \'Fjalla one\', sans-serif';
            ctx.textAlign = 'left';
            ctx.fillStyle = 'white';
            ctx.fillText(reportTitle, 15, 40);
            
            for (var i=0; i<bars.length; i++){
                
                var yPos = (i * (sectionHeight + sectionPaddingBottom)) + titleSectionHeight;
                var xPosText = 10;
                
                var textColRatio = 0.3;
                if (cWidth < 500) textColRatio = 0.5;
                if (cWidth < 370) textColRatio = 0.55;
                
                var xPosBar = cWidth * textColRatio;

                var maxBarWidth = cWidth - xPosBar - 20;
                
                // determine proportion for this bar
                var barFill1080p = bars[i].barFillFps1080pBefore + (stepCount * bars[i].barFillStepSize1080p);
                var barFillProportion1080p = (maxBarWidth / 200) * barFill1080p;
                var barFill1440p = bars[i].barFillFps1440pBefore + (stepCount * bars[i].barFillStepSize1440p);
                var barFillProportion1440p = (maxBarWidth / 200) * barFill1440p;
                var barFill2160p = bars[i].barFillFps2160pBefore + (stepCount * bars[i].barFillStepSize2160p);
                var barFillProportion2160p = (maxBarWidth / 200) * barFill2160p;
                var barSize = bars[i].barSizeFpsBefore + (stepCount * bars[i].barSizeStepSize);
                var barSizeProportion = (maxBarWidth / 200) * barSize;
                
                //
                // FILL BARS BACKGROUND
                ctx.fillStyle = backgroundBarsColor;
                roundRect(ctx, xPosBar, yPos, maxBarWidth, barHeight, barBorderRadius, true, false);
                roundRect(ctx, xPosBar, yPos + barMargin, maxBarWidth, barHeight, barBorderRadius, true, false);
                roundRect(ctx, xPosBar, yPos + (barMargin * 2), maxBarWidth, barHeight, barBorderRadius, true, false);
                
                //
                // FILL BARS CPU
                ctx.fillStyle = cpuBarsColor; // CPU
                roundRect(ctx, xPosBar, yPos, barSizeProportion, barHeight, barBorderRadius, true, false);
                roundRect(ctx, xPosBar, yPos + barMargin, barSizeProportion, barHeight, barBorderRadius, true, false);
                roundRect(ctx, xPosBar, yPos + (barMargin * 2), barSizeProportion, barHeight, barBorderRadius, true, false);
                
                //
                // FILL BARS GPU
                ctx.fillStyle = gpuBarsColor; // GPU
                if (barFillProportion1080p) roundRect(ctx, xPosBar, yPos, Math.min(barFillProportion1080p, barSizeProportion), barHeight, barBorderRadius, true, false);
                if (barFillProportion1440p) roundRect(ctx, xPosBar, yPos + barMargin, Math.min(barFillProportion1440p, barSizeProportion), barHeight, barBorderRadius, true, false);
                if (barFillProportion2160p) roundRect(ctx, xPosBar, yPos + (barMargin * 2), Math.min(barFillProportion2160p, barSizeProportion), barHeight, barBorderRadius, true, false);
                
                //
                // create tick and bar labels
                var tickFontSize = 10;
                ctx.font = tickFontSize + 'px  \'Open sans\', sans-serif';
                ctx.textAlign = 'left';
                ctx.fillStyle = 'white';
                ctx.fillText('1080p', xPosBar - (tickFontSize * 4), yPos + (barHeight/2) + (tickFontSize/2));
                ctx.fillText('1440p', xPosBar - (tickFontSize * 4), yPos + (barHeight/2) + (tickFontSize/2) + (barMargin));
                ctx.fillText('2160p', xPosBar - (tickFontSize * 4), yPos + (barHeight/2) + (tickFontSize/2) + (barMargin*2));
                
                //
                // create tick marks
                var tickOverlap = 3; // how much to overlap top and bottom
                var tickHeight = sectionHeight + tickOverlap*2;
                var tickLabelYPos = yPos + tickHeight + tickOverlap + tickFontSize;
                ctx.fillStyle = '#FFFFFF'; // ticks
                ctx.fillRect(xPosBar + (maxBarWidth * 0.15), yPos - tickOverlap, 1, tickHeight); //30 fps
                ctx.fillRect(xPosBar + (maxBarWidth * 0.3), yPos - tickOverlap, 1, tickHeight); //60 fps
                ctx.fillRect(xPosBar + (maxBarWidth * 0.6), yPos - tickOverlap, 1, tickHeight); //120 fps
                ctx.fillText('30', xPosBar + (maxBarWidth * 0.15) - (tickFontSize/2), tickLabelYPos);
                ctx.fillText('60', xPosBar + (maxBarWidth * 0.3) - (tickFontSize/2), tickLabelYPos);
                ctx.fillText('120', xPosBar + (maxBarWidth * 0.6) - (tickFontSize/2), tickLabelYPos);
                
                //
                // bar group labels (genres)
                var fontSize = 17;
                ctx.font = fontSize + 'px  \'Fjalla one\', sans-serif';
                var textLines = getLines(ctx, bars[i].title, xPosBar - 60);
                var gapSize = sectionHeight / (textLines.length + 1);
                for (var j=0; j<textLines.length; j++) {
                    var textYPos = yPos + (gapSize * (j + 1)) + (fontSize/2);
                    if (j > 0) {
                        textYPos += (fontSize/2) * j;
                    }
                    ctx.fillText(textLines[j], 15, textYPos);
                }
                
                //
                // legend
                ctx.fillStyle = '#000000';
                ctx.fillRect(cWidth/2 - legendWidth/2, cHeight - legendHeight - 15, legendWidth, legendHeight); //30 fps
                ctx.fillStyle = '#ffffff';
                ctx.font = '12px  \'Fjalla one\', sans-serif';
                ctx.fillText('Legend', cWidth/2 - 13, cHeight - legendHeight);
                ctx.font = '10px  \'Fjalla one\', sans-serif';
                ctx.fillText('CPU Max Framerate', (cWidth/2) - (legendWidth/2) + 22, cHeight - 10 - legendHeight * 0.35);
                ctx.fillText('Expected FPS', (cWidth/2) + 22, cHeight - 10 - legendHeight * 0.35);
                ctx.beginPath();
                ctx.arc((cWidth/2) - (legendWidth/2) + 15, cHeight - 15 - legendHeight * 0.35, 4, 0, Math.PI * 2, true); // CPU circle
                ctx.fillStyle = cpuBarsColor; // CPU
                ctx.fill();
                ctx.closePath();
                
                ctx.beginPath();
                ctx.arc((cWidth/2) + 15, cHeight - 15 - legendHeight * 0.35, 4, 0, Math.PI * 2, true); // GPU circle
                ctx.fillStyle = gpuBarsColor; // GPU
                ctx.fill();
                ctx.closePath();
                
            }
            
            var fontSize = 10;
            ctx.font = fontSize + 'px \'Fjalla one\', sans-serif';
            ctx.font = '10px';
            ctx.textAlign = 'right';
            ctx.fillStyle = 'white';
            ctx.fillText('200FPS Max', cWidth - 5, 15);
    
            if (stepCount < maxSteps) window.setTimeout(renderInsideElement, 15, elmId, bars, stepCount + 1, maxSteps);
        }
    
        
        
        
        
    });

</script>
{% endblock %}